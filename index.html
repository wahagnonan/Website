<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vedoo</title>

<!-- Tailwind CSS via CDN -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

<!-- Monaco Editor -->
<link rel="stylesheet" data-name="vs/editor/editor.main" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.43.0/min/vs/editor/editor.main.min.css">

<!-- xterm.js -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.1.0/css/xterm.css">

<script>
  tailwind.config = {
    darkMode: 'class',
    theme: {
      extend: {
        colors: {
          primary: {
            DEFAULT: '#FF5757',
            foreground: '#ffffff',
            hover: '#FF3A3A',
          },
          secondary: {
            DEFAULT: '#6366F1',
            foreground: '#ffffff',
          },
          border: {
            DEFAULT: '#E5E7EB',
            dark: '#374151',
          },
          background: {
            light: '#ffffff',
            dark: '#111827',
            panel: '#F9FAFB',
            'panel-dark': '#1F2937',
          },
        },
        fontFamily: {
          sans: ['Inter', 'sans-serif'],
        },
      }
    }
  }
</script>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
  
  body {
    font-family: 'Inter', sans-serif;
  }
  
  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
  ::-webkit-scrollbar-track {
    background: transparent;
  }
  ::-webkit-scrollbar-thumb {
    background: #CBD5E1;
    border-radius: 4px;
  }
  .dark ::-webkit-scrollbar-thumb {
    background: #4B5563;
  }
  ::-webkit-scrollbar-thumb:hover {
    background: #94A3B8;
  }
  .dark ::-webkit-scrollbar-thumb:hover {
    background: #6B7280;
  }
  
  /* Monaco editor container */
  #editor {
    height: 100%;
    width: 100%;
    min-height: 300px;
  }
  
  /* Terminal container */
  #terminal {
    height: 200px;
  }
  
  /* File tree styles */
  .file-tree-item {
    cursor: pointer;
    user-select: none;
    border-radius: 0.25rem;
    transition: background-color 0.15s ease;
  }
  
  .file-tree-item:hover {
    background-color: rgba(0, 0, 0, 0.05);
  }
  
  .dark .file-tree-item:hover {
    background-color: rgba(255, 255, 255, 0.05);
  }
  
  .file-children {
    margin-left: 1.25rem;
    display: none;
    transition: all 0.2s ease-in-out;
  }
  
  .file-children.open {
    display: block;
  }
  
  .chevron-rotate {
    transform: rotate(90deg);
    transition: transform 0.2s ease;
  }
  
  .preview-container {
    height: 100%;
    width: 100%;
    display: none;
    background: white;
    border: none;
  }
  
  .dark .preview-container {
    background: #1E1E1E;
  }
  
  .editor-container {
    height: calc(100% - 40px);
    overflow: hidden;
  }
  
  .terminal-container {
    border-top: 1px solid #E5E7EB;
  }
  
  .dark .terminal-container {
    border-top: 1px solid #374151;
  }
  
  .chat-container {
    border-left: 1px solid #E5E7EB;
  }
  
  .dark .chat-container {
    border-left: 1px solid #374151;
  }
  
  .bi {
    display: inline-block;
    vertical-align: -0.125em;
  }
  
  .tab-active {
    border-bottom: 2px solid #FF5757;
    color: #FF5757;
  }
  
  .dark .tab-active {
    border-bottom: 2px solid #FF5757;
    color: #FF5757;
  }
  
  .btn-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.375rem;
    padding: 0.5rem;
    transition: background-color 0.15s ease;
  }
  
  .btn-icon:hover {
    background-color: rgba(0, 0, 0, 0.05);
  }
  
  .dark .btn-icon:hover {
    background-color: rgba(255, 255, 255, 0.05);
  }
  
  .logo-gradient {
    background: linear-gradient(90deg, #FF5757 0%, #FF8A8A 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-fill-color: transparent;
  }
  
  /* Resizable panels */
  .resizable {
    position: relative;
  }
  
  .resizer {
    position: absolute;
    z-index: 10;
  }
  
  .resizer-horizontal {
    cursor: ew-resize;
    width: 5px;
    right: 0;
    top: 0;
    bottom: 0;
    background-color: transparent;
  }
  
  .resizer-horizontal:hover,
  .resizer-horizontal.active {
    background-color: rgba(0, 0, 0, 0.1);
  }
  
  .dark .resizer-horizontal:hover,
  .dark .resizer-horizontal.active {
    background-color: rgba(255, 255, 255, 0.1);
  }
  
  .resizer-vertical {
    cursor: ns-resize;
    height: 5px;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: transparent;
  }
  
  .resizer-vertical:hover,
  .resizer-vertical.active {
    background-color: rgba(0, 0, 0, 0.1);
  }
  
  .dark .resizer-vertical:hover,
  .dark .resizer-vertical.active {
    background-color: rgba(255, 255, 255, 0.1);
  }
  
  .chat-messages {
    height: calc(100% - 120px);
    overflow-y: auto;
  }
  
  .file-active {
    background-color: rgba(0, 0, 0, 0.05);
  }
  
  .dark .file-active {
    background-color: rgba(255, 255, 255, 0.05);
  }
  
  .file-tree-item i.bi-chevron-right {
    transition: transform 0.2s ease;
  }
  
  .terminal-caret {
    animation: blink 1s step-end infinite;
  }
  
  @keyframes blink {
    from, to {
      opacity: 1;
    }
    50% {
      opacity: 0;
    }
  }
</style>
</head>
<body class="bg-white text-gray-900 dark:bg-gray-900 dark:text-white transition-colors duration-200">
<div class="flex h-screen flex-col">
  <!-- Header -->
  <header class="sticky top-0 z-50 flex h-14 items-center justify-between border-b border-border dark:border-border-dark bg-white px-4 dark:bg-gray-900">
    <div class="flex items-center gap-4">
      <div class="flex items-center">
        <a href="#" class="flex items-center gap-2 font-semibold">
          <span class="text-2xl font-bold logo-gradient">Vedoo</span>
        </a>
      </div>
    </div>
    <div class="flex items-center gap-2">
      <button id="theme-toggle" class="btn-icon" aria-label="Toggle theme">
        <i class="bi bi-sun-fill text-lg hidden dark:block"></i>
        <i class="bi bi-moon-fill text-lg block dark:hidden"></i>
      </button>
      <button class="btn-icon" aria-label="GitHub">
        <i class="bi bi-github text-lg"></i>
      </button>
      <button class="btn-icon" aria-label="Settings">
        <i class="bi bi-gear-fill text-lg"></i>
      </button>
      <div class="flex h-8 w-8 items-center justify-center rounded-full bg-primary text-white">
        <span class="text-sm font-medium">U</span>
      </div>
    </div>
  </header>
  
  <!-- Main Content -->
  <div class="flex flex-1 overflow-hidden">
    <!-- Sidebar / File Explorer with resizer -->
    <div id="file-explorer" class="resizable w-64 bg-background-panel dark:bg-background-panel-dark overflow-hidden flex flex-col">
      <div class="flex items-center justify-between p-2 border-b border-border dark:border-border-dark">
        <span class="text-sm font-medium">EXPLORER</span>
        <div class="flex items-center">
          <button class="btn-icon p-1" id="refresh-explorer" aria-label="Refresh">
            <i class="bi bi-arrow-clockwise text-sm"></i>
          </button>
        </div>
      </div>
      <div class="overflow-y-auto flex-1 p-2">
        <!-- File Tree for Django Project -->
        <div class="file-tree">
          <!-- manage.py -->
          <div class="file-tree-item flex items-center p-1.5 rounded" data-file="manage.py">
            <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
            <span class="text-sm">manage.py</span>
          </div>
          
          <!-- requirements.txt -->
          <div class="file-tree-item flex items-center p-1.5 rounded" data-file="requirements.txt">
            <i class="bi bi-file-earmark-text-fill text-gray-500 mr-1.5"></i>
            <span class="text-sm">requirements.txt</span>
          </div>
          
          <!-- .gitignore -->
          <div class="file-tree-item flex items-center p-1.5 rounded" data-file=".gitignore">
            <i class="bi bi-file-earmark-text-fill text-gray-500 mr-1.5"></i>
            <span class="text-sm">.gitignore</span>
          </div>
          
          <!-- README.md -->
          <div class="file-tree-item flex items-center p-1.5 rounded" data-file="README.md">
            <i class="bi bi-file-earmark-text-fill text-blue-500 mr-1.5"></i>
            <span class="text-sm">README.md</span>
          </div>
          
          <!-- VPRO (project folder) -->
          <div class="file-tree-item flex items-center p-1.5 rounded" data-folder="VPRO">
            <i class="bi bi-chevron-right mr-1.5"></i>
            <i class="bi bi-folder-fill text-blue-500 mr-1.5"></i>
            <span class="text-sm">VPRO</span>
          </div>
          <div class="file-children" id="VPRO-children">
            <div class="file-tree-item flex items-center p-1.5 rounded" data-file="VPRO/settings.py">
              <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
              <span class="text-sm">settings.py</span>
            </div>
            <div class="file-tree-item flex items-center p-1.5 rounded" data-file="VPRO/urls.py">
              <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
              <span class="text-sm">urls.py</span>
            </div>
            <div class="file-tree-item flex items-center p-1.5 rounded" data-file="VPRO/wsgi.py">
              <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
              <span class="text-sm">wsgi.py</span>
            </div>
            <div class="file-tree-item flex items-center p-1.5 rounded" data-file="VPRO/asgi.py">
              <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
              <span class="text-sm">asgi.py</span>
            </div>
            <div class="file-tree-item flex items-center p-1.5 rounded" data-file="VPRO/__init__.py">
              <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
              <span class="text-sm">__init__.py</span>
            </div>
          </div>
          
          <!-- Vapp (app folder) -->
          <div class="file-tree-item flex items-center p-1.5 rounded" data-folder="Vapp">
            <i class="bi bi-chevron-right mr-1.5"></i>
            <i class="bi bi-folder-fill text-blue-500 mr-1.5"></i>
            <span class="text-sm">Vapp</span>
          </div>
          <div class="file-children" id="Vapp-children">
            <div class="file-tree-item flex items-center p-1.5 rounded" data-file="Vapp/models.py">
              <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
              <span class="text-sm">models.py</span>
            </div>
            <div class="file-tree-item flex items-center p-1.5 rounded" data-file="Vapp/views.py">
              <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
              <span class="text-sm">views.py</span>
            </div>
            <div class="file-tree-item flex items-center p-1.5 rounded" data-file="Vapp/urls.py">
              <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
              <span class="text-sm">urls.py</span>
            </div>
            <div class="file-tree-item flex items-center p-1.5 rounded" data-file="Vapp/admin.py">
              <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
              <span class="text-sm">admin.py</span>
            </div>
            <div class="file-tree-item flex items-center p-1.5 rounded" data-file="Vapp/apps.py">
              <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
              <span class="text-sm">apps.py</span>
            </div>
            <div class="file-tree-item flex items-center p-1.5 rounded" data-file="Vapp/tests.py">
              <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
              <span class="text-sm">tests.py</span>
            </div>
            <div class="file-tree-item flex items-center p-1.5 rounded" data-file="Vapp/__init__.py">
              <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
              <span class="text-sm">__init__.py</span>
            </div>
            
            <!-- Vapp/migrations folder -->
            <div class="file-tree-item flex items-center p-1.5 rounded" data-folder="Vapp/migrations">
              <i class="bi bi-chevron-right mr-1.5"></i>
              <i class="bi bi-folder-fill text-blue-500 mr-1.5"></i>
              <span class="text-sm">migrations</span>
            </div>
            <div class="file-children" id="Vapp/migrations-children">
              <div class="file-tree-item flex items-center p-1.5 rounded" data-file="Vapp/migrations/__init__.py">
                <i class="bi bi-file-earmark-code-fill text-green-500 mr-1.5"></i>
                <span class="text-sm">__init__.py</span>
              </div>
            </div>
            
            <!-- Vapp/templates folder -->
            <div class="file-tree-item flex items-center p-1.5 rounded" data-folder="Vapp/templates">
              <i class="bi bi-chevron-right mr-1.5"></i>
              <i class="bi bi-folder-fill text-blue-500 mr-1.5"></i>
              <span class="text-sm">templates</span>
            </div>
            <div class="file-children" id="Vapp/templates-children">
              <div class="file-tree-item flex items-center p-1.5 rounded" data-folder="Vapp/templates/Vapp">
                <i class="bi bi-chevron-right mr-1.5"></i>
                <i class="bi bi-folder-fill text-blue-500 mr-1.5"></i>
                <span class="text-sm">Vapp</span>
              </div>
              <div class="file-children" id="Vapp/templates/Vapp-children">
                <div class="file-tree-item flex items-center p-1.5 rounded" data-file="Vapp/templates/Vapp/index.html">
                  <i class="bi bi-file-earmark-code-fill text-orange-500 mr-1.5"></i>
                  <span class="text-sm">index.html</span>
                </div>
                <div class="file-tree-item flex items-center p-1.5 rounded" data-file="Vapp/templates/Vapp/base.html">
                  <i class="bi bi-file-earmark-code-fill text-orange-500 mr-1.5"></i>
                  <span class="text-sm">base.html</span>
                </div>
              </div>
            </div>
            
            <!-- Vapp/static folder -->
            <div class="file-tree-item flex items-center p-1.5 rounded" data-folder="Vapp/static">
              <i class="bi bi-chevron-right mr-1.5"></i>
              <i class="bi bi-folder-fill text-blue-500 mr-1.5"></i>
              <span class="text-sm">static</span>
            </div>
            <div class="file-children" id="Vapp/static-children">
              <div class="file-tree-item flex items-center p-1.5 rounded" data-folder="Vapp/static/css">
                <i class="bi bi-chevron-right mr-1.5"></i>
                <i class="bi bi-folder-fill text-blue-500 mr-1.5"></i>
                <span class="text-sm">css</span>
              </div>
              <div class="file-children" id="Vapp/static/css-children">
                <div class="file-tree-item flex items-center p-1.5 rounded" data-file="Vapp/static/css/style.css">
                  <i class="bi bi-file-earmark-code-fill text-purple-500 mr-1.5"></i>
                  <span class="text-sm">style.css</span>
                </div>
              </div>
              <div class="file-tree-item flex items-center p-1.5 rounded" data-folder="Vapp/static/js">
                <i class="bi bi-chevron-right mr-1.5"></i>
                <i class="bi bi-folder-fill text-blue-500 mr-1.5"></i>
                <span class="text-sm">js</span>
              </div>
              <div class="file-children" id="Vapp/static/js-children">
                <div class="file-tree-item flex items-center p-1.5 rounded" data-file="Vapp/static/js/main.js">
                  <i class="bi bi-file-earmark-code-fill text-yellow-500 mr-1.5"></i>
                  <span class="text-sm">main.js</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="resizer resizer-horizontal" id="file-explorer-resizer"></div>
    </div>
    
    <!-- Main Editor Area -->
    <div class="flex-1 flex overflow-hidden">
      <div class="flex-1 flex flex-col overflow-hidden">
        <!-- Editor Tabs -->
        <div class="flex items-center border-b border-border dark:border-border-dark bg-background-panel dark:bg-background-panel-dark">
          <div class="flex items-center px-4 py-2">
            <div class="flex items-center">
              <button id="preview-btn" class="px-3 py-1.5 text-sm flex items-center gap-1 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-t-md">
                <i class="bi bi-eye text-sm"></i>
                <span>Preview</span>
              </button>
              <button id="code-btn" class="px-3 py-1.5 text-sm flex items-center gap-1 tab-active hover:bg-gray-100 dark:hover:bg-gray-800 rounded-t-md">
                <i class="bi bi-code-slash text-sm"></i>
                <span>Code</span>
              </button>
            </div>
          </div>
          <div class="ml-auto flex items-center px-4">
            <button id="toggle-terminal-btn" class="btn-icon" aria-label="Toggle Terminal">
              <i class="bi bi-terminal text-lg"></i>
            </button>
          </div>
        </div>
        
        <!-- File Path -->
        <div id="file-path" class="flex items-center border-b border-border dark:border-border-dark bg-white px-4 py-1.5 text-sm text-gray-500 dark:bg-gray-900 dark:text-gray-400">
          <span>Sélectionnez un fichier pour voir son contenu</span>
        </div>
        
        <!-- Editor Container -->
        <div class="editor-container flex-1 overflow-hidden">
          <div id="editor"></div>
          <iframe id="preview-frame" class="preview-container" sandbox="allow-same-origin allow-scripts"></iframe>
        </div>
        
        <!-- Terminal -->
        <div id="terminal" class="terminal-container h-48 bg-black text-white hidden">
          <div class="flex items-center justify-between border-b border-gray-700 px-4 py-1.5">
            <span class="text-sm font-medium">TERMINAL</span>
            <div class="flex items-center">
              <button class="text-gray-400 hover:text-white px-2">
                <i class="bi bi-plus"></i>
              </button>
              <button class="text-gray-400 hover:text-white px-2" id="clear-terminal-btn">
                <i class="bi bi-trash"></i>
              </button>
              <button id="close-terminal-btn" class="text-gray-400 hover:text-white px-2">
                <i class="bi bi-x-lg"></i>
              </button>
            </div>
          </div>
          <div id="terminal-container" class="h-full p-2 overflow-auto"></div>
        </div>
      </div>
      
      <!-- Chat Panel (vertical on right) -->
      <div class="chat-container w-80 bg-white dark:bg-gray-900 flex flex-col">
        <div class="border-b border-border dark:border-border-dark p-3">
          <h2 class="font-medium">Chat</h2>
        </div>
        
        <!-- Chat Messages -->
        <div class="chat-messages p-3">
          <div class="mb-4">
            <div class="flex items-start mb-1">
              <div class="flex h-8 w-8 items-center justify-center rounded-full bg-primary text-white mr-2 flex-shrink-0">
                <span class="text-sm font-medium">V</span>
              </div>
              <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-3 max-w-[85%]">
                <p class="text-sm">Bonjour ! Comment puis-je vous aider aujourd'hui ?</p>
              </div>
            </div>
            <span class="text-xs text-gray-500 dark:text-gray-400 ml-10">10:30 AM</span>
          </div>
          
          <div class="mb-4">
            <div class="flex items-start justify-end mb-1">
              <div class="bg-primary text-white rounded-lg p-3 max-w-[85%]">
                <p class="text-sm">Je travaille sur un projet Django et j'ai besoin d'aide avec les modèles.</p>
              </div>
              <div class="flex h-8 w-8 items-center justify-center rounded-full bg-gray-200 dark:bg-gray-700 ml-2 flex-shrink-0">
                <span class="text-sm font-medium">U</span>
              </div>
            </div>
            <span class="text-xs text-gray-500 dark:text-gray-400 mr-10 flex justify-end">10:32 AM</span>
          </div>
          
          <div class="mb-4">
            <div class="flex items-start mb-1">
              <div class="flex h-8 w-8 items-center justify-center rounded-full bg-primary text-white mr-2 flex-shrink-0">
                <span class="text-sm font-medium">V</span>
              </div>
              <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-3 max-w-[85%]">
                <p class="text-sm">Bien sûr ! Les modèles Django définissent la structure de vos données. Vous pouvez créer un modèle en définissant une classe qui hérite de django.db.models.Model. Que souhaitez-vous modéliser ?</p>
              </div>
            </div>
            <span class="text-xs text-gray-500 dark:text-gray-400 ml-10">10:33 AM</span>
          </div>
        </div>
        
        <!-- Chat Input -->
        <div class="mt-auto p-3 border-t border-border dark:border-border-dark">
          <div class="relative">
            <textarea
              id="chat-input"
              placeholder="Posez votre question..."
              class="w-full rounded-lg border border-gray-300 bg-white px-4 py-2 pr-10 text-sm focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary dark:border-gray-700 dark:bg-gray-800 dark:text-white dark:focus:border-primary"
              rows="3"
            ></textarea>
            <div class="absolute bottom-2 right-2 flex items-center space-x-1">
              <button class="rounded p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                <i class="bi bi-paperclip text-lg"></i>
              </button>
              <button class="rounded p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                <i class="bi bi-stars text-lg"></i>
              </button>
            </div>
          </div>
          <div class="flex justify-between items-center mt-2">
            <span class="text-xs text-gray-500 dark:text-gray-400">Vedoo peut faire des erreurs.</span>
            <button id="send-message-btn" class="rounded-lg bg-primary px-3 py-1.5 text-sm font-medium text-white hover:bg-primary-hover">
              <i class="bi bi-send-fill"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Monaco Editor -->
<script>var require = { paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.43.0/min/vs' } };</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.43.0/min/vs/loader.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.43.0/min/vs/editor/editor.main.nls.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.43.0/min/vs/editor/editor.main.js"></script>

<!-- xterm.js -->
<script src="https://cdn.jsdelivr.net/npm/xterm@5.1.0/lib/xterm.js"></script>

<script>
  // File content data
  
  
  // Initialize Monaco Editor
  document.addEventListener('DOMContentLoaded', function() {
    let editor;
    let currentFile = null;
    let isDarkMode = document.documentElement.classList.contains('dark');
    
    // Theme toggle
    const themeToggle = document.getElementById('theme-toggle');
    themeToggle.addEventListener('click', function() {
      document.documentElement.classList.toggle('dark');
      isDarkMode = document.documentElement.classList.contains('dark');
      
      // Update Monaco Editor theme
      if (isDarkMode) {
        monaco.editor.setTheme('vs-dark');
      } else {
        monaco.editor.setTheme('vs');
      }
    });
    
    // Initialize Monaco Editor
    require(['vs/editor/editor.main'], function() {
      editor = monaco.editor.create(document.getElementById('editor'), {
        value: 'Sélectionnez un fichier pour voir son contenu',
        language: 'plaintext',
        theme: isDarkMode ? 'vs-dark' : 'vs',
        automaticLayout: true,
        minimap: {
          enabled: false
        },
        scrollBeyondLastLine: false,
        fontSize: 14,
        lineNumbers: 'on',
        renderLineHighlight: 'all',
        scrollbar: {
          vertical: 'visible',
          horizontal: 'visible'
        }
      });
      
      window.addEventListener('resize', function() {
        editor.layout();
      });
      
      // Preview and Code toggling
      const previewBtn = document.getElementById('preview-btn');
      const codeBtn = document.getElementById('code-btn');
      const previewFrame = document.getElementById('preview-frame');
      const editorElement = document.getElementById('editor');
      
      previewBtn.addEventListener('click', function() {
        if (!currentFile) return;
        
        // Only preview HTML files
        const extension = currentFile.split('.').pop().toLowerCase();
        if (extension !== 'html') {
          alert('Preview is only available for HTML files.');
          return;
        }
        
        // Switch to preview mode
        previewBtn.classList.add('tab-active');
        codeBtn.classList.remove('tab-active');
        
        // Hide editor, show preview
        editorElement.style.display = 'none';
        previewFrame.style.display = 'block';
        
        // Load content into iframe
        const content = editor.getValue();
        const frameDoc = previewFrame.contentDocument || previewFrame.contentWindow.document;
        frameDoc.open();
        frameDoc.write(content);
        frameDoc.close();
      });
      
      codeBtn.addEventListener('click', function() {
        // Switch to code mode
        codeBtn.classList.add('tab-active');
        previewBtn.classList.remove('tab-active');
        
        // Show editor, hide preview
        editorElement.style.display = 'block';
        previewFrame.style.display = 'none';
      });
      
      // File click handler
      const fileItems = document.querySelectorAll('.file-tree-item[data-file]');
      fileItems.forEach(item => {
        item.addEventListener('click', function() {
          const filePath = this.getAttribute('data-file');
          
          // Remove active class from all files
          document.querySelectorAll('.file-tree-item').forEach(el => {
            el.classList.remove('file-active');
          });
          
          // Add active class to clicked file
          this.classList.add('file-active');
          
          // Update file path display
          document.getElementById('file-path').textContent = filePath;
          
          // Get file content
          const content = fileContents[filePath] || `// File content not available for ${filePath}`;
          
          // Determine language based on file extension
          const extension = filePath.split('.').pop().toLowerCase();
          let language = 'plaintext';
          
          if (extension === 'py') language = 'python';
          else if (extension === 'js') language = 'javascript';
          else if (extension === 'html') language = 'html';
          else if (extension === 'css') language = 'css';
          else if (extension === 'md') language = 'markdown';
          else if (extension === 'txt' || extension === 'gitignore') language = 'plaintext';
          
          // Update editor content and language
          monaco.editor.setModelLanguage(editor.getModel(), language);
          editor.setValue(content);
          
          currentFile = filePath;
          
          // If in preview mode and the file is not HTML, switch to code view
          if (previewBtn.classList.contains('tab-active') && extension !== 'html') {
            codeBtn.click();
          }
          // If HTML file and in preview mode, refresh the preview
          else if (extension === 'html' && previewBtn.classList.contains('tab-active')) {
            previewBtn.click();
          }
        });
      });
    });
    
    // Initialize enhanced terminal functionality
    const terminalContainer = document.getElementById('terminal-container');
    const toggleTerminalBtn = document.getElementById('toggle-terminal-btn');
    const closeTerminalBtn = document.getElementById('close-terminal-btn');
    const clearTerminalBtn = document.getElementById('clear-terminal-btn');
    const terminal = document.getElementById('terminal');
    
    // Terminal state
    let commandHistory = [];
    let historyIndex = -1;
    let currentCommand = '';
    let terminalPrompt = '$ ';
    let terminalContent = '';
    
    // Initialize terminal
    function initTerminal() {
      terminalContent = `
<div class="mb-2 text-green-400">Django development server initialized (v4.2.7)</div>
<div>$ python manage.py runserver</div>
<div>Watching for file changes with StatReloader</div>
<div>Performing system checks...</div>
<div></div>
<div>System check identified no issues (0 silenced).</div>
<div>May 07, 2025 - 14:30:45</div>
<div>Django version 4.2.7, using settings 'VPRO.settings'</div>
<div>Starting development server at <a href="#" class="text-blue-400 hover:underline">http://127.0.0.1:8000/</a></div>
<div>Quit the server with CONTROL-C.</div>
<div class="mt-2">$ <span class="terminal-caret">▋</span></div>
`;
      updateTerminal();
    }
    
    // Update terminal content
    function updateTerminal() {
      terminalContainer.innerHTML = terminalContent;
      terminalContainer.scrollTop = terminalContainer.scrollHeight;
    }
    
    // Process terminal command
    function processCommand(cmd) {
      terminalContent += `<div>$ ${cmd}</div>`;
      
      // Command history
      if (cmd.trim() !== '') {
        commandHistory.push(cmd);
        historyIndex = commandHistory.length;
      }
      
      // Simple command processing
      if (cmd.trim().startsWith('python')) {
        if (cmd.includes('runserver')) {
          terminalContent += `<div>Watching for file changes with StatReloader</div>
<div>Performing system checks...</div>
<div></div>
<div>System check identified no issues (0 silenced).</div>
<div>May 07, 2025 - 14:30:45</div>
<div>Django version 4.2.7, using settings 'VPRO.settings'</div>
<div>Starting development server at <a href="#" class="text-blue-400 hover:underline">http://127.0.0.1:8000/</a></div>
<div>Quit the server with CONTROL-C.</div>`;
        } else if (cmd.includes('migrate')) {
          terminalContent += `<div>Operations to perform:</div>
<div>  Apply all migrations: admin, auth, contenttypes, sessions, Vapp</div>
<div>Running migrations:</div>
<div>  Applying contenttypes.0001_initial... OK</div>
<div>  Applying auth.0001_initial... OK</div>
<div>  Applying admin.0001_initial... OK</div>
<div>  Applying admin.0002_logentry_remove_auto_add... OK</div>
<div>  Applying admin.0003_logentry_add_action_flag_choices... OK</div>
<div>  Applying contenttypes.0002_remove_content_type_name... OK</div>
<div>  Applying auth.0002_alter_permission_name_max_length... OK</div>
<div>  Applying auth.0003_alter_user_email_max_length... OK</div>
<div>  Applying auth.0004_alter_user_username_opts... OK</div>
<div>  Applying auth.0005_alter_user_last_login_null... OK</div>
<div>  Applying auth.0006_require_contenttypes_0002... OK</div>
<div>  Applying auth.0007_alter_validators_add_error_messages... OK</div>
<div>  Applying auth.0008_alter_user_username_max_length... OK</div>
<div>  Applying auth.0009_alter_user_last_name_max_length... OK</div>
<div>  Applying auth.0010_alter_group_name_max_length... OK</div>
<div>  Applying auth.0011_update_proxy_permissions... OK</div>
<div>  Applying auth.0012_alter_user_first_name_max_length... OK</div>
<div>  Applying sessions.0001_initial... OK</div>
<div>  Applying Vapp.0001_initial... OK</div>`;
        } else {
          terminalContent += `<div>Unknown command: ${cmd}</div>`;
        }
      } else if (cmd.trim() === 'ls') {
        terminalContent += `<div>manage.py  requirements.txt  VPRO/  Vapp/  .gitignore  README.md</div>`;
      } else if (cmd.trim() === 'clear') {
        terminalContent = '';
      } else if (cmd.trim() !== '') {
        terminalContent += `<div>command not found: ${cmd}</div>`;
      }
      
      terminalContent += `<div class="mt-1">$ <span class="terminal-caret">▋</span></div>`;
      updateTerminal();
    }
    
    // Initialize terminal
    initTerminal();
    
    // Terminal keyboard input handler
    document.addEventListener('keydown', function(e) {
      if (!terminal.classList.contains('hidden') && document.activeElement !== document.getElementById('chat-input')) {
        const key = e.key;
        
        if (key === 'Enter') {
          e.preventDefault();
          processCommand(currentCommand);
          currentCommand = '';
        } else if (key === 'Backspace') {
          e.preventDefault();
          currentCommand = currentCommand.slice(0, -1);
          terminalContent = terminalContent.replace(/<div class="mt-1">\$ <span class="terminal-caret">▋<\/span><\/div>$/, `<div class="mt-1">$ ${currentCommand}<span class="terminal-caret">▋</span></div>`);
          updateTerminal();
        } else if (key === 'ArrowUp') {
          e.preventDefault();
          if (historyIndex > 0) {
            historyIndex--;
            currentCommand = commandHistory[historyIndex];
            terminalContent = terminalContent.replace(/<div class="mt-1">\$ .*<span class="terminal-caret">▋<\/span><\/div>$/, `<div class="mt-1">$ ${currentCommand}<span class="terminal-caret">▋</span></div>`);
            updateTerminal();
          }
        } else if (key === 'ArrowDown') {
          e.preventDefault();
          if (historyIndex < commandHistory.length - 1) {
            historyIndex++;
            currentCommand = commandHistory[historyIndex];
          } else {
            historyIndex = commandHistory.length;
            currentCommand = '';
          }
          terminalContent = terminalContent.replace(/<div class="mt-1">\$ .*<span class="terminal-caret">▋<\/span><\/div>$/, `<div class="mt-1">$ ${currentCommand}<span class="terminal-caret">▋</span></div>`);
          updateTerminal();
        } else if (key.length === 1) {
          e.preventDefault();
          currentCommand += key;
          terminalContent = terminalContent.replace(/<div class="mt-1">\$ .*<span class="terminal-caret">▋<\/span><\/div>$/, `<div class="mt-1">$ ${currentCommand}<span class="terminal-caret">▋</span></div>`);
          updateTerminal();
        }
      }
    });
    
    // Terminal UI controls
    toggleTerminalBtn.addEventListener('click', function() {
      terminal.classList.toggle('hidden');
      if (!terminal.classList.contains('hidden')) {
        terminalContainer.scrollTop = terminalContainer.scrollHeight;
        // Focus terminal
        window.setTimeout(() => {
          terminalContainer.focus();
        }, 100);
      }
    });
    
    closeTerminalBtn.addEventListener('click', function() {
      terminal.classList.add('hidden');
    });
    
    clearTerminalBtn.addEventListener('click', function() {
      terminalContent = '<div class="mt-1">$ <span class="terminal-caret">▋</span></div>';
      updateTerminal();
    });
    
    // Click in terminal focuses input
    terminalContainer.addEventListener('click', function() {
      terminalContainer.focus();
    });
    
    // File tree functionality - enhanced with animations
    const fileTreeItems = document.querySelectorAll('.file-tree-item[data-folder]');
    fileTreeItems.forEach(item => {
      item.addEventListener('click', function() {
        const folder = this.getAttribute('data-folder');
        const children = document.getElementById(`${folder}-children`);
        const arrow = this.querySelector('.bi-chevron-right');
        
        if (children) {
          children.classList.toggle('open');
          arrow.classList.toggle('chevron-rotate');
        }
      });
    });
    
    // Refresh explorer button
    document.getElementById('refresh-explorer').addEventListener('click', function() {
      // Simulate refresh with animation
      this.querySelector('i').classList.add('animate-spin');
      
      setTimeout(() => {
        this.querySelector('i').classList.remove('animate-spin');
      }, 1000);
    });
    
    // Chat functionality
    const chatInput = document.getElementById('chat-input');
    const sendMessageBtn = document.getElementById('send-message-btn');
    const chatMessages = document.querySelector('.chat-messages');
    
    function sendChatMessage() {
      const message = chatInput.value.trim();
      if (message === '') return;
      
      // Add user message
      const now = new Date();
      const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      
      const userMessageHtml = `
      <div class="mb-4">
        <div class="flex items-start justify-end mb-1">
          <div class="bg-primary text-white rounded-lg p-3 max-w-[85%]">
            <p class="text-sm">${message}</p>
          </div>
          <div class="flex h-8 w-8 items-center justify-center rounded-full bg-gray-200 dark:bg-gray-700 ml-2 flex-shrink-0">
            <span class="text-sm font-medium">U</span>
          </div>
        </div>
        <span class="text-xs text-gray-500 dark:text-gray-400 mr-10 flex justify-end">${timeString}</span>
      </div>
      `;
      
      chatMessages.insertAdjacentHTML('beforeend', userMessageHtml);
      chatInput.value = '';
      
      // Auto scroll to bottom
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      // Simulate assistant response after a short delay
      setTimeout(() => {
        const botResponses = [
          "Je vais examiner cela pour vous.",
          "Voici comment vous pouvez définir un modèle Django pour les utilisateurs.",
          "Avez-vous essayé d'utiliser les relations ManyToMany?",
          "Les vues basées sur les classes sont souvent plus efficaces pour ce type de fonctionnalité.",
          "Vous pourriez optimiser cette requête avec select_related() ou prefetch_related()."
        ];
        
        const randomResponse = botResponses[Math.floor(Math.random() * botResponses.length)];
        
        const botMessageHtml = `
        <div class="mb-4">
          <div class="flex items-start mb-1">
            <div class="flex h-8 w-8 items-center justify-center rounded-full bg-primary text-white mr-2 flex-shrink-0">
              <span class="text-sm font-medium">V</span>
            </div>
            <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-3 max-w-[85%]">
              <p class="text-sm">${randomResponse}</p>
            </div>
          </div>
          <span class="text-xs text-gray-500 dark:text-gray-400 ml-10">${timeString}</span>
        </div>
        `;
        
        chatMessages.insertAdjacentHTML('beforeend', botMessageHtml);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }, 1000);
    }
    
    sendMessageBtn.addEventListener('click', sendChatMessage);
    
    chatInput.addEventListener('keydown', function(e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendChatMessage();
      }
    });
    
    // Resizable panels
    const fileExplorer = document.getElementById('file-explorer');
    const fileExplorerResizer = document.getElementById('file-explorer-resizer');
    
    let isResizing = false;
    
    fileExplorerResizer.addEventListener('mousedown', function(e) {
      isResizing = true;
      document.body.classList.add('select-none');
      fileExplorerResizer.classList.add('active');
    });
    
    document.addEventListener('mousemove', function(e) {
      if (!isResizing) return;
      
      // Calculate new width
      const newWidth = e.clientX;
      
      // Set minimum and maximum width
      if (newWidth >= 150 && newWidth <= window.innerWidth / 2) {
        fileExplorer.style.width = newWidth + 'px';
      }
    });
    
    document.addEventListener('mouseup', function() {
      if (isResizing) {
        isResizing = false;
        document.body.classList.remove('select-none');
        fileExplorerResizer.classList.remove('active');
      }
    });
  });
</script>
</body>
</html>
